

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lingvo.tasks.car.waymo.waymo_ap_metric module &mdash; Lingvo  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.tasks.car.waymo.waymo_decoder module" href="lingvo.tasks.car.waymo.waymo_decoder.html" />
    <link rel="prev" title="lingvo.tasks.car.waymo.export_to_submission_format module" href="lingvo.tasks.car.waymo.export_to_submission_format.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.tasks.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.html">lingvo.tasks package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.car.html">lingvo.tasks.car package</a> &raquo;</li>
        
          <li><a href="lingvo.tasks.car.waymo.html">lingvo.tasks.car.waymo package</a> &raquo;</li>
        
      <li>lingvo.tasks.car.waymo.waymo_ap_metric module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lingvo.tasks.car.waymo.waymo_ap_metric.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.tasks.car.waymo.waymo_ap_metric">
<span id="lingvo-tasks-car-waymo-waymo-ap-metric-module"></span><h1>lingvo.tasks.car.waymo.waymo_ap_metric module<a class="headerlink" href="#module-lingvo.tasks.car.waymo.waymo_ap_metric" title="Permalink to this headline">¶</a></h1>
<p>Average Precision metric class for Waymo open dataset.</p>
<p>The Waymo library provides a metrics breakdown API for a set of breakdowns
implemented in their library.  This wrapper uses our basic abstraction for
building AP metrics but only allows breakdowns that are supported in the
Waymo breakdown API.  Should you want other breakdowns, consider using the
standard AP metrics implementation with our custom breakdowns.</p>
<dl class="function">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric._BuildWaymoMetricConfig">
<code class="sig-prename descclassname">lingvo.tasks.car.waymo.waymo_ap_metric.</code><code class="sig-name descname">_BuildWaymoMetricConfig</code><span class="sig-paren">(</span><em class="sig-param">metadata</em>, <em class="sig-param">box_type</em>, <em class="sig-param">waymo_breakdown_metrics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#_BuildWaymoMetricConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric._BuildWaymoMetricConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the Config proto for Waymo’s metric op.</p>
</dd></dl>

<dl class="class">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.tasks.car.waymo.waymo_ap_metric.</code><code class="sig-name descname">WaymoAPMetrics</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lingvo.tasks.car.ap_metric.html#lingvo.tasks.car.ap_metric.APMetrics" title="lingvo.tasks.car.ap_metric.APMetrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.tasks.car.ap_metric.APMetrics</span></code></a></p>
<p>The Waymo Open Dataset implementation of AP metric.</p>
<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.Params">
<em class="property">classmethod </em><code class="sig-name descname">Params</code><span class="sig-paren">(</span><em class="sig-param">metadata</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Params builder for APMetrics.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._GetData">
<code class="sig-name descname">_GetData</code><span class="sig-paren">(</span><em class="sig-param">classid</em>, <em class="sig-param">difficulty=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">num_points=None</em>, <em class="sig-param">rotation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics._GetData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._GetData" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns groundtruth and prediction for the classid in a NestedMap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classid</strong> – int32 specifying the class</p></li>
<li><p><strong>difficulty</strong> – String in [easy, moderate, hard]. If None specified, all
difficulty levels are permitted.</p></li>
<li><p><strong>distance</strong> – int32 specifying a binned Euclidean distance of the ground truth
bounding box. If None is specified, all distances are selected.</p></li>
<li><p><strong>num_points</strong> – int32 specifying a binned number of laser points within the
ground truth bounding box. If None is specified, all boxes are selected.</p></li>
<li><p><strong>rotation</strong> – int32 specifying a binned rotation within the ground truth
bounding box. If None is specified, all boxes are selected.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NestedMap containing iou_threshold, groundtruth and predictions for
specified, classid, difficulty level and binned distance. If no bboxes
are found with these parameters, returns None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._BuildMetric">
<code class="sig-name descname">_BuildMetric</code><span class="sig-paren">(</span><em class="sig-param">feed_data</em>, <em class="sig-param">classid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics._BuildMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._BuildMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct tensors and the feed_dict for Waymo metric op.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed_data</strong> – a NestedMap returned by _GetData().</p></li>
<li><p><strong>classid</strong> – integer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>scalar_metrics: a dict mapping all the metric names to fetch tensors.</p></li>
<li><p>curves: a dict mapping all the curve names to fetch tensors.</p></li>
<li><p>feed_dict: a dict mapping the tensors in feed_tensors to feed values.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A tuple of 3 dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._ComputeFinalMetrics">
<code class="sig-name descname">_ComputeFinalMetrics</code><span class="sig-paren">(</span><em class="sig-param">classids=None</em>, <em class="sig-param">difficulty=None</em>, <em class="sig-param">distance=None</em>, <em class="sig-param">num_points=None</em>, <em class="sig-param">rotation=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics._ComputeFinalMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics._ComputeFinalMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute precision-recall curves as well as average precision.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classids</strong> – A list of N int32.</p></li>
<li><p><strong>difficulty</strong> – String in [easy, moderate, hard]. If None specified, all
difficulty levels are permitted.</p></li>
<li><p><strong>distance</strong> – int32 specifying a binned Euclidean distance of the ground truth
bounding box. If None is specified, all distances are selected.</p></li>
<li><p><strong>num_points</strong> – int32 specifying a binned number of laser points within the
ground truth bounding box. If None is specified, all boxes are selected.</p></li>
<li><p><strong>rotation</strong> – int32 specifying a binned rotation within the ground truth
bounding box. If None is specified, all boxes are selected.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict. Each entry in the dict is a list of C (number of classes) dicts
containing mapping from metric names to individual results. Individual
entries may be the following items.
- scalars: A list of C (number of classes) dicts mapping metric
names to scalar values.
- curves: A list of C dicts mapping metrics names to np.float32
arrays of shape [NumberOfPrecisionRecallPoints()+1, 2]. In the last
dimension, 0 indexes precision and 1 indexes recall.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.value">
<em class="property">property </em><code class="sig-name descname">value</code><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns weighted mAP over all eval classes.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.Summary">
<code class="sig-name descname">Summary</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoAPMetrics.Summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoAPMetrics.Summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements custom Summary for Waymo metrics.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric">
<em class="property">class </em><code class="sig-prename descclassname">lingvo.tasks.car.waymo.waymo_ap_metric.</code><code class="sig-name descname">WaymoBreakdownMetric</code><span class="sig-paren">(</span><em class="sig-param">p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lingvo.tasks.car.breakdown_metric.html#lingvo.tasks.car.breakdown_metric.BreakdownMetric" title="lingvo.tasks.car.breakdown_metric.BreakdownMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">lingvo.tasks.car.breakdown_metric.BreakdownMetric</span></code></a></p>
<p>Calculate average precision as function of difficulty.</p>
<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.Params">
<em class="property">classmethod </em><code class="sig-name descname">Params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.Params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.ComputeMetrics">
<code class="sig-name descname">ComputeMetrics</code><span class="sig-paren">(</span><em class="sig-param">compute_metrics_fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.ComputeMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.ComputeMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute precision-recall analysis conditioned on particular metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compute_metrics_fn</strong> – Function that that calculates precision-recall metrics
and accepts named arguments for conditioning. Typically, this would be
APMetrics._ComputeFinalMetrics().</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nothing</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.GenerateSummaries">
<code class="sig-name descname">GenerateSummaries</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.GenerateSummaries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.GenerateSummaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an image summary for precision recall by difficulty.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.AccumulateHistogram">
<code class="sig-name descname">AccumulateHistogram</code><span class="sig-paren">(</span><em class="sig-param">result</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.AccumulateHistogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.AccumulateHistogram" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.AccumulateCumulative">
<code class="sig-name descname">AccumulateCumulative</code><span class="sig-paren">(</span><em class="sig-param">result</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.AccumulateCumulative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.AccumulateCumulative" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate cumulative of real-valued statistic by label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>result</strong> – A NestedMap with these fields:
.labels: [N]. Groundtruth boxes’ labels.
.bboxes: [N, 7]. Groundtruth boxes coordinates.
.difficulties: [N]. Groundtruth boxes difficulties.
.num_points: [N]. Number of laser points in bounding boxes.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nothing</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.NumBinsOfHistogram">
<code class="sig-name descname">NumBinsOfHistogram</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/tasks/car/waymo/waymo_ap_metric.html#WaymoBreakdownMetric.NumBinsOfHistogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.tasks.car.waymo.waymo_ap_metric.WaymoBreakdownMetric.NumBinsOfHistogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns int32 of number of bins in histogram.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lingvo.tasks.car.waymo.waymo_decoder.html" class="btn btn-neutral float-right" title="lingvo.tasks.car.waymo.waymo_decoder module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lingvo.tasks.car.waymo.export_to_submission_format.html" class="btn btn-neutral float-left" title="lingvo.tasks.car.waymo.export_to_submission_format module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>