

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lingvo.core.py_utils module &mdash; Lingvo  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lingvo.core.quant_utils module" href="lingvo.core.quant_utils.html" />
    <link rel="prev" title="lingvo.core.predictor module" href="lingvo.core.predictor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Lingvo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="lingvo.html">lingvo package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lingvo.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="lingvo.core.html">lingvo.core package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="lingvo.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="lingvo.core.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tasks.html">lingvo.tasks package</a></li>
<li class="toctree-l3"><a class="reference internal" href="lingvo.tools.html">lingvo.tools package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lingvo.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lingvo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="lingvo.html">lingvo package</a> &raquo;</li>
        
          <li><a href="lingvo.core.html">lingvo.core package</a> &raquo;</li>
        
      <li>lingvo.core.py_utils module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lingvo.core.py_utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lingvo.core.py_utils">
<span id="lingvo-core-py-utils-module"></span><h1>lingvo.core.py_utils module<a class="headerlink" href="#module-lingvo.core.py_utils" title="Permalink to this headline">¶</a></h1>
<p>Common utilities.</p>
<dl class="function">
<dt id="lingvo.core.py_utils.Assert">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">Assert</code><span class="sig-paren">(</span><em>condition</em>, <em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#Assert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.Assert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_equal">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_equal</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_equal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_greater_equal">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_greater_equal</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_greater_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_greater_equal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_greater">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_greater</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_greater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_greater" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_less_equal">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_less_equal</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_less_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_less_equal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_less">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_less</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_less"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_less" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_between">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_between</code><span class="sig-paren">(</span><em>x</em>, <em>l</em>, <em>r</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_shape_match">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_shape_match</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_shape_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_shape_match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.assert_same_dim0">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">assert_same_dim0</code><span class="sig-paren">(</span><em>xs</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#assert_same_dim0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.assert_same_dim0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._CheckNumerics">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_CheckNumerics</code><span class="sig-paren">(</span><em>x</em>, <em>message=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_CheckNumerics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._CheckNumerics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.CheckNumerics">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">CheckNumerics</code><span class="sig-paren">(</span><em>inp</em>, <em>message=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#CheckNumerics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.CheckNumerics" title="Permalink to this definition">¶</a></dt>
<dd><p>Check numerics for tensors in inp.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.with_dependencies">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">with_dependencies</code><span class="sig-paren">(</span><em>dependencies</em>, <em>output_tensor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#with_dependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.with_dependencies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._PrintOptions">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_PrintOptions</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_PrintOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._PrintOptions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._Print">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_Print</code><span class="sig-paren">(</span><em>name</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_Print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._Print" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.Log">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">Log</code><span class="sig-paren">(</span><em>value</em>, <em>prefix</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#Log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.Log" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints out values of tensors.</p>
<dl class="docutils">
<dt>Useful for debugging. E.g.,</dt>
<dd>x = … a tf.Tensor …
y = … a tf.Tensor …
z = compute(x, y)
z = Log(z, ‘debug compute()’, x=x, y=y)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> – A Tensor. Log happens after this tensor’s computed.</li>
<li><strong>prefix</strong> – Every tensor is logged with this prefix.</li>
<li><strong>**kwargs</strong> – keywords and tensors. Tensors are logged in the sort order of
these keywards.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value is returned.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._Save">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_Save</code><span class="sig-paren">(</span><em>steps</em>, <em>prefix</em>, <em>key</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_Save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._Save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.Save">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">Save</code><span class="sig-paren">(</span><em>value</em>, <em>filename_prefix</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#Save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.Save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves values of tensors into files.</p>
<dl class="docutils">
<dt>Useful for debugging. E.g.,</dt>
<dd>x = … a tf.Tensor …
y = … a tf.Tensor …
z = compute(x, y)
z = Save(z, ‘/path/tmp’, x=x, y=y, z=z)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> – A Tensor. Saving happens after this tensor is computed.</li>
<li><strong>filename_prefix</strong> – Every tensor is saved with this filename prefix.</li>
<li><strong>**kwargs</strong> – keywords and tensors. Tensors are logged in the sort order of
these keywards.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">value is returned.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.HasRank">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">HasRank</code><span class="sig-paren">(</span><em>tensor</em>, <em>expected_rank</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#HasRank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.HasRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Syntactic sugar for asserting that tensor has the expected rank.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.HasShape">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">HasShape</code><span class="sig-paren">(</span><em>tensor</em>, <em>expected_shape</em>, <em>ndims=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#HasShape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.HasShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Syntactic sugar for asserting that tensor has the expected shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensor</strong> – A Tensor.</li>
<li><strong>expected_shape</strong> – A Python list or a 1D tensor.</li>
<li><strong>ndims</strong> – If not None, check only the first <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndims</span></code> dimensions of <code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor</span></code>.
Must be equal to the length of <code class="xref py py-obj docutils literal notranslate"><span class="pre">expected_shape</span></code> if not None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The input <code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">A runtime error if the assertion fails.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetShape">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetShape</code><span class="sig-paren">(</span><em>tensor</em>, <em>ndims=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetShape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns tensor’s shape as a list which can be unpacked, unlike tf.shape.</p>
<p>Tries to return static shape if it’s available. Note that this means
some of the outputs will be ints while the rest will be Tensors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tensor</strong> – The input tensor.</li>
<li><strong>ndims</strong> – If not None, returns the shapes for the first <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndims</span></code> dimensions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.use_xla">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">use_xla</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#use_xla"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.use_xla" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.use_tpu">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">use_tpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#use_tpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.use_tpu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.nas_run">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">nas_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#nas_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.nas_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.tpu_compat">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">tpu_compat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#tpu_compat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.tpu_compat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.use_resource_variables">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">use_resource_variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#use_resource_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.use_resource_variables" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.outside_all_rewrites">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">outside_all_rewrites</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#outside_all_rewrites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.outside_all_rewrites" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.RunOnTpuHost">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">RunOnTpuHost</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RunOnTpuHost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RunOnTpuHost" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the given function call on TPU host.</p>
<p>Invokes func(*args, **kwargs) directly if not running on tpu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> – the function to invoke.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The function return value.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SetTpuDeviceAssignment">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SetTpuDeviceAssignment</code><span class="sig-paren">(</span><em>tpu_device_assignment</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SetTpuDeviceAssignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SetTpuDeviceAssignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ClearTpuDevice">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ClearTpuDevice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ClearTpuDevice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ClearTpuDevice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetTpuDeviceAssignment">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetTpuDeviceAssignment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetTpuDeviceAssignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetTpuDeviceAssignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SessionConfig">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SessionConfig</code><span class="sig-paren">(</span><em>soft_placement=True</em>, <em>inline=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SessionConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SessionConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a session config proto.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>soft_placement</strong> – Turns allow_soft_placement on iff True.</li>
<li><strong>inline</strong> – Turns do_function_inlining on iff True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A TF session config proto.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils.NestedMap">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">NestedMap</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>A simpler helper to maintain a dict.</p>
<p>E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span> <span class="o">=</span> <span class="n">NestedMap</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">foo</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">foo</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="lingvo.core.py_utils.NestedMap._HAS_DYNAMIC_ATTRIBUTES">
<code class="descname">_HAS_DYNAMIC_ATTRIBUTES</code><em class="property"> = True</em><a class="headerlink" href="#lingvo.core.py_utils.NestedMap._HAS_DYNAMIC_ATTRIBUTES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; a shallow copy of D<a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.DeepCopy">
<code class="descname">DeepCopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.DeepCopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.DeepCopy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.NestedMap.CheckKey">
<em class="property">static </em><code class="descname">CheckKey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.CheckKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.CheckKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts that key is valid NestedMap key.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.Flatten">
<code class="descname">Flatten</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.Flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.Flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten the <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> and returns values in a list.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.FlattenItems">
<code class="descname">FlattenItems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.FlattenItems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.FlattenItems" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten the <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> and returns &lt;key, value&gt; pairs in a list.</p>
<p>For lists, keys will be returned with <code class="xref py py-obj docutils literal notranslate"><span class="pre">_</span></code> appended, e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">x.y_10.z</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A list of &lt;key, value&gt; pairs, where keys for nested entries will be
represented in the form of <code class="xref py py-obj docutils literal notranslate"><span class="pre">foo.bar</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.Transform">
<code class="descname">Transform</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.Transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of this <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with fn applied on each value.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.Filter">
<code class="descname">Filter</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.Filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.Filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of this <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with entries that fn(entry) is True.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.FilterKeyVal">
<code class="descname">FilterKeyVal</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.FilterKeyVal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.FilterKeyVal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of this <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with filtered by fn.</p>
<p>If fn(key, entry) is True, the entry is copied into the returned NestedMap.
Otherwise, it is not copied.
For lists, keys will be processed with indices, e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">x.y[10].z</span></code>.
This is different from FlattenItems.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fn</strong> – a callable of (string, entry)-&gt;boolean.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> contains copied entries from this <code class="xref py py-obj docutils literal notranslate"><span class="pre">'.NestedMap</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.Pack">
<code class="descname">Pack</code><span class="sig-paren">(</span><em>lst</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.Pack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.Pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of this with each value replaced by a value in lst.</p>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.IsCompatible">
<code class="descname">IsCompatible</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.IsCompatible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.IsCompatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if self and other is compatible.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>other</strong> – Another <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.  If x and y are two compatible <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>,
<code class="xref py py-obj docutils literal notranslate"><span class="pre">x.Pack(y.Flatten())</span></code> produces y and <code class="xref py py-obj docutils literal notranslate"><span class="pre">y.Pack(x.Flatten())</span></code> produces x.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="lingvo.core.py_utils.NestedMap.DebugString">
<code class="descname">DebugString</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NestedMap.DebugString"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NestedMap.DebugString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a debug string for this <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils._Unique">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_Unique</code><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_Unique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._Unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A helper to uniqify variables in a NestedMap.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ToUniqueList">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ToUniqueList</code><span class="sig-paren">(</span><em>nmap</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ToUniqueList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ToUniqueList" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the flattened <code class="xref py py-obj docutils literal notranslate"><span class="pre">nmap</span></code> with duplicates removed.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ReadOnlyAttrDictView">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ReadOnlyAttrDictView</code><span class="sig-paren">(</span><em>backing</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ReadOnlyAttrDictView"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ReadOnlyAttrDictView" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps a dict to provide a read-only view of its contents.</p>
<p>Dict keys can also be accessed by attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>backing</strong> – Dict-like object to wrap.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Read-only Mapping that can be accessed by index ([‘foo’]) or attr (d.foo).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils.RNNCellStateInit">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">RNNCellStateInit</code><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RNNCellStateInit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RNNCellStateInit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>State initialization functions for RNN cell init state.</p>
<dl class="staticmethod">
<dt id="lingvo.core.py_utils.RNNCellStateInit._Params">
<em class="property">static </em><code class="descname">_Params</code><span class="sig-paren">(</span><em>method</em>, <em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RNNCellStateInit._Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RNNCellStateInit._Params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.RNNCellStateInit.Zeros">
<em class="property">static </em><code class="descname">Zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RNNCellStateInit.Zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RNNCellStateInit.Zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>tf.zeros().</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.RNNCellStateInit.RandomNormal">
<em class="property">static </em><code class="descname">RandomNormal</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RNNCellStateInit.RandomNormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RNNCellStateInit.RandomNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>tf.random.normal().</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.DefaultRNNCellStateInit">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">DefaultRNNCellStateInit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#DefaultRNNCellStateInit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.DefaultRNNCellStateInit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.InitRNNCellState">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">InitRNNCellState</code><span class="sig-paren">(</span><em>shape</em>, <em>init=None</em>, <em>dtype=None</em>, <em>name=None</em>, <em>is_eval=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#InitRNNCellState"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.InitRNNCellState" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial state definitions for RNN cell implementations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>shape</strong> – A array of ints/symbols for specifying the shape of the state.</li>
<li><strong>init</strong> – Hyperparameters as returned by one of the static implemetaitons in
RNNCellStateInit.</li>
<li><strong>dtype</strong> – The dype of the states. Defaults to tf.float32.</li>
<li><strong>name</strong> – An optional name for the operation.</li>
<li><strong>is_eval</strong> – Bool, set to True if we need special behavior in eval mode.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A Tensor of the specified shape, and sampled from the distribution as
defined by the init parameters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils.WeightInit">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">WeightInit</code><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Static class providing weight initialization config params.</p>
<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit._Params">
<em class="property">static </em><code class="descname">_Params</code><span class="sig-paren">(</span><em>method</em>, <em>scale</em>, <em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit._Params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit._Params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.Gaussian">
<em class="property">static </em><code class="descname">Gaussian</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_normal(0, 1.0).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.Uniform">
<em class="property">static </em><code class="descname">Uniform</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.Uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.Uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_uniform(-1.0, 1.0).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.UniformPositive">
<em class="property">static </em><code class="descname">UniformPositive</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.UniformPositive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.UniformPositive" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_uniform(0., 1.0).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.Xavier">
<em class="property">static </em><code class="descname">Xavier</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.Xavier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.Xavier" title="Permalink to this definition">¶</a></dt>
<dd><p>Xavier initialization (x = sqrt(6. / (in + out)); [-x, x]).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.GeoMeanXavier">
<em class="property">static </em><code class="descname">GeoMeanXavier</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.GeoMeanXavier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.GeoMeanXavier" title="Permalink to this definition">¶</a></dt>
<dd><p>A variant of Xavier (x = sqrt(3. / sqrt(in * out)); [-x, x]).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.Constant">
<em class="property">static </em><code class="descname">Constant</code><span class="sig-paren">(</span><em>scale=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.Constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.Constant" title="Permalink to this definition">¶</a></dt>
<dd><p>scale.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.TruncatedGaussian">
<em class="property">static </em><code class="descname">TruncatedGaussian</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.TruncatedGaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.TruncatedGaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.truncated_normal(0, 1.0).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.GaussianSqrtDim">
<em class="property">static </em><code class="descname">GaussianSqrtDim</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.GaussianSqrtDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.GaussianSqrtDim" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_normal(0, 1 / sqrt(dim0)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.GaussianSqrtFanIn">
<em class="property">static </em><code class="descname">GaussianSqrtFanIn</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.GaussianSqrtFanIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.GaussianSqrtFanIn" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_normal(0, 1 / sqrt(fan_in)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.GaussianSqrtFanOut">
<em class="property">static </em><code class="descname">GaussianSqrtFanOut</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.GaussianSqrtFanOut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.GaussianSqrtFanOut" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.random_normal(0, 1 / sqrt(fan_out)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.UniformSqrtDim">
<em class="property">static </em><code class="descname">UniformSqrtDim</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.UniformSqrtDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.UniformSqrtDim" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.uniform(-1 / sqrt(dim0), 1 / sqrt(dim0)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.UniformUnitScaling">
<em class="property">static </em><code class="descname">UniformUnitScaling</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.UniformUnitScaling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.UniformUnitScaling" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * sqrt(3) / sqrt(dim0) * tf.uniform(-1, 1).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtDim">
<em class="property">static </em><code class="descname">TruncatedGaussianSqrtDim</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.TruncatedGaussianSqrtDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtDim" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.truncated_normal(0, 1 / sqrt(dim0)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtFanIn">
<em class="property">static </em><code class="descname">TruncatedGaussianSqrtFanIn</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.TruncatedGaussianSqrtFanIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtFanIn" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.truncated_normal(0, 1 / sqrt(fan_in)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtFanOut">
<em class="property">static </em><code class="descname">TruncatedGaussianSqrtFanOut</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.TruncatedGaussianSqrtFanOut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.TruncatedGaussianSqrtFanOut" title="Permalink to this definition">¶</a></dt>
<dd><p>scale * tf.truncated_normal(0, 1 / sqrt(fan_out)).</p>
</dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.KaimingUniformFanInRelu">
<em class="property">static </em><code class="descname">KaimingUniformFanInRelu</code><span class="sig-paren">(</span><em>scale=1.0</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.KaimingUniformFanInRelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.KaimingUniformFanInRelu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="lingvo.core.py_utils.WeightInit.KaimingUniformFanInLeakyRelu">
<em class="property">static </em><code class="descname">KaimingUniformFanInLeakyRelu</code><span class="sig-paren">(</span><em>scale=2.23606797749979</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightInit.KaimingUniformFanInLeakyRelu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightInit.KaimingUniformFanInLeakyRelu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.DefaultParamInit">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">DefaultParamInit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#DefaultParamInit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.DefaultParamInit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.IsDefaultParamInit">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">IsDefaultParamInit</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#IsDefaultParamInit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.IsDefaultParamInit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.WeightParams">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">WeightParams</code><span class="sig-paren">(</span><em>shape</em>, <em>init=None</em>, <em>dtype=None</em>, <em>collections=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a hyperparams for a weight variable given the shape/init/dtype.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.FindNeeded">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">FindNeeded</code><span class="sig-paren">(</span><em>endpoints</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#FindNeeded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.FindNeeded" title="Permalink to this definition">¶</a></dt>
<dd><p>List names of tensors and operations required to compute endpoints.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.FindNeededInList">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">FindNeededInList</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>endpoints</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#FindNeededInList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.FindNeededInList" title="Permalink to this definition">¶</a></dt>
<dd><p>Return tensors from tensor_list needed to compute any of endpoints.</p>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils._CollectionGetter">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_CollectionGetter</code><span class="sig-paren">(</span><em>key</em>, <em>default_factory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_CollectionGetter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._CollectionGetter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Get graph local value from a defined collection.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.OpportunisticVariableReuseScope">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">OpportunisticVariableReuseScope</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#OpportunisticVariableReuseScope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.OpportunisticVariableReuseScope" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.VariableRenameScope">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">VariableRenameScope</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#VariableRenameScope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.VariableRenameScope" title="Permalink to this definition">¶</a></dt>
<dd><p>Append the renaming rules to the stack of renames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>renames</strong> – pairs of (regexp, new_name_format). If the regexp matches, the
new_name_format will be interpolated using the matched groups.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body">scope in which the renaming rules are applied</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetVariableName">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetVariableName</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetVariableName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetVariableName" title="Permalink to this definition">¶</a></dt>
<dd><p>Get variable name after application of all renaming rules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> – untransformed variable name with scope_name prepended</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">name possibly modified using renaming rules</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GenerateSeedFromName">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GenerateSeedFromName</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GenerateSeedFromName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GenerateSeedFromName" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random seed from a name string.</p>
</dd></dl>

<dl class="class">
<dt id="lingvo.core.py_utils._ThreadLocalStack">
<em class="property">class </em><code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_ThreadLocalStack</code><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_ThreadLocalStack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._ThreadLocalStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">thread._local</span></code></p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.VariableShapePrefixContext">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">VariableShapePrefixContext</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#VariableShapePrefixContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.VariableShapePrefixContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a shape prefix to variable created by CreateVariable().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>shape_prefix</strong> – a positive integer of shape prefix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body">None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetVariableShapePrefixes">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetVariableShapePrefixes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetVariableShapePrefixes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetVariableShapePrefixes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of shape prefixes for CreateVariable().</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetFanInFanOut">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetFanInFanOut</code><span class="sig-paren">(</span><em>shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetFanInFanOut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetFanInFanOut" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (fan_in, fan_out) of a weight variable of the give shape.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.CreateVariable">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">CreateVariable</code><span class="sig-paren">(</span><em>name</em>, <em>params</em>, <em>reuse=None</em>, <em>trainable=True</em>, <em>init_wrapper=None</em>, <em>collections=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#CreateVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.CreateVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tf.Variable according to param_config.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> – A string, name of the variable.</li>
<li><strong>params</strong> – A WeightParams specifying the details of how this variable should be
constructed and initialized.</li>
<li><strong>reuse</strong> – Whether or not to reuse an existing variable. It has the same
semantics as the reuse arg in tf.variable_scope.</li>
<li><strong>trainable</strong> – Whether or not the variable is trainable.</li>
<li><strong>init_wrapper</strong> – a callback which takes a tf initializer callable and returns a
tensor. It is used when shape of the variable isn’t statically
determinable.</li>
<li><strong>collections</strong> – Override the default variable collection (
tf.GraphKeys.GLOBAL_VARIABLES).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tf.identity(var), var pair. The tf.identity() node is colocated
with var. In the case of FLAGS.no_identity_on_vars, simply returns
a var, var pair.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GlobalStepContext">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GlobalStepContext</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GlobalStepContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GlobalStepContext" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetGlobalStep">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetGlobalStep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetGlobalStep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetGlobalStep" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global_step.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetOrCreateGlobalStepVar">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetOrCreateGlobalStepVar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetOrCreateGlobalStepVar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetOrCreateGlobalStepVar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the global_step variable, creating it if it does not exist.</p>
<p>Prefer GetGlobalStep if a tensor rather than a tf.Variable is sufficient.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.LogMultiLines">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">LogMultiLines</code><span class="sig-paren">(</span><em>label</em>, <em>lines</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#LogMultiLines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.LogMultiLines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._LogPlacement">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_LogPlacement</code><span class="sig-paren">(</span><em>label</em>, <em>theta</em>, <em>copy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_LogPlacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._LogPlacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs theta and its copy’s device placement.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.CreateLocalTheta">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">CreateLocalTheta</code><span class="sig-paren">(</span><em>theta</em>, <em>device_list=None</em>, <em>label=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#CreateLocalTheta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.CreateLocalTheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates local copy of theta and shards across devices device list.</p>
<p>Leaves variables intact.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> – a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of variables.</li>
<li><strong>device_list</strong> – list of devices to shard across. If None, defaults to a list
[‘’].</li>
<li><strong>label</strong> – Logging label.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of identity() wrapped theta</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._GetVarsToLoad">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_GetVarsToLoad</code><span class="sig-paren">(</span><em>all_vars</em>, <em>variable_loading_rules</em>, <em>var_ignore_rules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_GetVarsToLoad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._GetVarsToLoad" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines variables to load and their names in checkpoint.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._OverrideVarsFromCheckpoint">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_OverrideVarsFromCheckpoint</code><span class="sig-paren">(</span><em>sess</em>, <em>all_vars</em>, <em>checkpoint_path</em>, <em>variable_loading_rules</em>, <em>var_ignore_rules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_OverrideVarsFromCheckpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._OverrideVarsFromCheckpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Overrides variables from a provided checkpoint.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.OverrideVarsFromCheckpoints">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">OverrideVarsFromCheckpoints</code><span class="sig-paren">(</span><em>session</em>, <em>all_vars</em>, <em>ckpts_loading_rules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#OverrideVarsFromCheckpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.OverrideVarsFromCheckpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Overrides model variables from checkpoints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>session</strong> – Tensorflow session.</li>
<li><strong>all_vars</strong> – List of all the parameters in the model.</li>
<li><strong>ckpts_loading_rules</strong> – A dictionary of checkpoint path: loading rules.
Checkpoint path must be a path to a pretrained model, and loading rules is
expected to be a tuple of two lists. The first consisting of tuples of
strings defining (regex to match parameter names in the model to override,
format string to determine the corresponding var in the checkpoint), and
the second list consisting of a list of regexes to match parameter names
in the model which should not be overridden, even if they match those in
the loading rules.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – if colliding vars exist or loading rules is not a list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._ComputeGradientsSimple">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_ComputeGradientsSimple</code><span class="sig-paren">(</span><em>loss</em>, <em>all_vars</em>, <em>grad_aggregation_method</em>, <em>colocate_gradients_with_ops</em>, <em>gate_gradients</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_ComputeGradientsSimple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._ComputeGradientsSimple" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ComputeTpuEmbeddingGradients">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ComputeTpuEmbeddingGradients</code><span class="sig-paren">(</span><em>loss</em>, <em>activation_dict</em>, <em>tpu_embedding</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ComputeTpuEmbeddingGradients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ComputeTpuEmbeddingGradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a TpuEmbedding SendGradient op.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loss</strong> – The loss to backprop from.</li>
<li><strong>activation_dict</strong> – String feature -&gt; embedding activations dict.</li>
<li><strong>tpu_embedding</strong> – TPUEmbedding instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._ComputeGradientsTpu">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_ComputeGradientsTpu</code><span class="sig-paren">(</span><em>loss</em>, <em>all_vars</em>, <em>grad_aggregation_method</em>, <em>colocate_gradients_with_ops</em>, <em>gate_gradients</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_ComputeGradientsTpu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._ComputeGradientsTpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes gradients for local loss across whole TPU cluster.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._ComputeGradientsTpuNas">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_ComputeGradientsTpuNas</code><span class="sig-paren">(</span><em>loss</em>, <em>all_vars</em>, <em>grad_aggregation_method</em>, <em>colocate_gradients_with_ops</em>, <em>gate_gradients</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_ComputeGradientsTpuNas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._ComputeGradientsTpuNas" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes gradients for local loss across whole TPU cluster.</p>
<p>This implementation specializes for the case where weight params maybe used
for different number of times in the forward computation, so that gradients
should be normalized by the actual number of times they are being computed.</p>
<p>TODO(yonghui): Maybe merge this implementation with the _ComputeGradientsTpu
one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loss</strong> – The loss to backprop from.</li>
<li><strong>all_vars</strong> – Vars with respect to which gradients are to be computed.</li>
<li><strong>grad_aggregation_method</strong> – aggregation method to use when calling
tf.gradients.</li>
<li><strong>colocate_gradients_with_ops</strong> – boolean, whether or not to colocate gradient op
with the original op.</li>
<li><strong>gate_gradients</strong> – boolean, flag to be passed to tf.gradients.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">gradients to be passed back.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ComputeGradients">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ComputeGradients</code><span class="sig-paren">(</span><em>loss</em>, <em>vmap</em>, <em>grad_aggregation_method=1</em>, <em>colocate_gradients_with_ops=True</em>, <em>gate_gradients=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ComputeGradients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ComputeGradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes gradients of variables in vmap w.r.t loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loss</strong> – A scalar Tensor.</li>
<li><strong>vmap</strong> – A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of variables.</li>
<li><strong>grad_aggregation_method</strong> – Specifies the method used to combine gradient
terms. Accepted values are constants defined in the class
AggregationMethod.</li>
<li><strong>colocate_gradients_with_ops</strong> – If True, try colocating gradients with the
corresponding op.</li>
<li><strong>gate_gradients</strong> – If True, add a tuple around the gradients returned for an
operations. This avoids some race conditions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">var_grad - a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient). You can view
var_grad as an ordered list of (key, (var, grad)) tuples. Every
key of var_grad exists in vmap. Every variable in vmap that
contributes to loss must exist in var_grad. Every var of var_grad
must exist in vmap.  grad is the corresponding gradient computed
for var. grad is guaranteed to be not None.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.MaskGradients">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">MaskGradients</code><span class="sig-paren">(</span><em>var_grad</em>, <em>grad_mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#MaskGradients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.MaskGradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes gradients of non-masked variables in vmap w.r.t loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>var_grad</strong> – A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient)</li>
<li><strong>grad_mask</strong> – A dict of (variable name, mask).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">var_grad - a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, mask * gradient).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ApplyGradMultiplier">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ApplyGradMultiplier</code><span class="sig-paren">(</span><em>vs_gs_scale</em>, <em>grad_scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ApplyGradMultiplier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ApplyGradMultiplier" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale gradients by grad_scale on same device as corresponding variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vs_gs_scale</strong> – A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient, scale).</li>
<li><strong>grad_scale</strong> – If None, each vs_gs entry has the scale. Otherwise, grad_scale
applies to every entry.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient * grad_scale). In particular, if
grad_scale is 0, the result gradient is always 0, even if the input
gradient is inf or nan.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.HasNanOrInfGradient">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">HasNanOrInfGradient</code><span class="sig-paren">(</span><em>var_grads</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#HasNanOrInfGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.HasNanOrInfGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a bool tensor to indicate if <code class="xref py py-obj docutils literal notranslate"><span class="pre">var_grads</span></code> contains NaNs or Infs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>var_grads</strong> – A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with (var, grad) tuple as the map value.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A bool scalar tensor to indicate if the <code class="xref py py-obj docutils literal notranslate"><span class="pre">var_grads</span></code> contains NaNs or Infs.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ApplyGradNormCliping">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ApplyGradNormCliping</code><span class="sig-paren">(</span><em>vs_gs</em>, <em>norm=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ApplyGradNormCliping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ApplyGradNormCliping" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip gradients to norm on same device as corresponding variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vs_gs</strong> – A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient).</li>
<li><strong>norm</strong> – Each tensor’s gradient will be scaled down to have a maximum L2-norm
value of <code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, scaled_gradient). In particular, if
grad_scale is 0, the result gradient is always 0, even if the input
gradient is inf or nan.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.AdjustGradientsWithLpLoss">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">AdjustGradientsWithLpLoss</code><span class="sig-paren">(</span><em>var_grads</em>, <em>lp_regularizer_weight</em>, <em>p=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#AdjustGradientsWithLpLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.AdjustGradientsWithLpLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusts the map of (var, grad) with Lp regularization, where p=1.0 or 2.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>var_grads</strong> – a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient).</li>
<li><strong>lp_regularizer_weight</strong> – Lp regularization weight.</li>
<li><strong>p</strong> – For now we support 1.0 or 2.0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A tuple (lp_loss, var_grads).</p>
<ul class="simple">
<li>lp_loss: A scalar. The lp loss.</li>
<li>var_grads: a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> of (variable, gradient) regulated by Lp.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SplitRecursively">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SplitRecursively</code><span class="sig-paren">(</span><em>x</em>, <em>num_splits</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SplitRecursively"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SplitRecursively" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits Tensors in ‘x’ recursively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – a Tensor, or a list or NestMap containing Tensors to split.</li>
<li><strong>num_splits</strong> – number of splits per Tensor.</li>
<li><strong>axis</strong> – the split axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A list of split values of length ‘num_splits’.</p>
<ul class="simple">
<li>If ‘x’ is a Tensor, a list of split Tensors.</li>
<li>If ‘x’ is a list, a list of lists, where each sublist has the same length
as ‘x’ and the k’th element in each sublist corresponds to a split of the
k’th element from ‘x’.</li>
<li>If ‘x’ is a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>, a list of <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>, where each field
corresponds to a split from the same field of ‘x’.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ConcatRecursively">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ConcatRecursively</code><span class="sig-paren">(</span><em>splits</em>, <em>axis=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ConcatRecursively"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ConcatRecursively" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenates tensors from ‘splits’.</p>
<p>This is the inverse function of SplitRecursively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>splits</strong> – a list of splits to concatenate, where elements can be Tensors,
lists, or <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>. The elements must share the same type and
structure.  For example, list elements must have the same length;
<a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> must have the same set of fields.</li>
<li><strong>axis</strong> – the concatenation axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Concatenated data.</p>
<ul class="simple">
<li>If input ‘splits’ are Tensors, returns a concatenated Tensor.</li>
<li>If input ‘splits’ are lists, returns a list of the same length where the
k’th element represents concatenated data of the k’th element from each
split.</li>
<li>If input ‘splits’ are <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>, returns a <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with each field
concatenated from corresponding fields of input splits.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code> – if ‘splits’ is not a list or elements of ‘splits’ do not have
known or matching types.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – if ‘splits’ is empty or elements of ‘splits’ do not have
matching structures.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.AddToPruningCollections">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">AddToPruningCollections</code><span class="sig-paren">(</span><em>weight</em>, <em>mask</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#AddToPruningCollections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.AddToPruningCollections" title="Permalink to this definition">¶</a></dt>
<dd><p>Add mask, threshold, and weight vars to their respective collections.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.WeightedAvg">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">WeightedAvg</code><span class="sig-paren">(</span><em>values</em>, <em>weights</em>, <em>sum_reduction_fn=&lt;function reduce_sum_v1&gt;</em>, <em>name=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightedAvg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightedAvg" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes weighted average of values from a tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>values</strong> – a tensor of values</li>
<li><strong>weights</strong> – a tensor of weights</li>
<li><strong>sum_reduction_fn</strong> – called to reduce the values and weights to single value</li>
<li><strong>name</strong> – name of metric.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A tuple (avg, total_weight).</p>
<ul class="simple">
<li>avg: weighted average value</li>
<li>total_weight: sum of all weights</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.WeightedAvgOfMetrics">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">WeightedAvgOfMetrics</code><span class="sig-paren">(</span><em>metrics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#WeightedAvgOfMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.WeightedAvgOfMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weighted average of metrics in the list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>metrics</strong> – list of dictionaries of metrics</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ret_dict - dictionary of weighted averages of each metrics.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ConcatPerExampleTensors">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ConcatPerExampleTensors</code><span class="sig-paren">(</span><em>per_example</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ConcatPerExampleTensors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ConcatPerExampleTensors" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate per-example tensors from many hosts into one large block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>per_example</strong> – list of dictionaries of per-example tensors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">ret_dict - string -&gt; concatenated tensors.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.CombineMetrics">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">CombineMetrics</code><span class="sig-paren">(</span><em>loss_metric_weight_pairs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#CombineMetrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.CombineMetrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines metrics from <code class="xref py py-obj docutils literal notranslate"><span class="pre">loss_metric_weight_pairs</span></code> according to weights.</p>
<p>Keys must either exist in all metrics, in which it will be processed as a
weighted sum, or exist in only one metrics, in which case it will be copied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>loss_metric_weight_pairs</strong> – a list of (metrics, weight) pairs, where each
weight is a float and each metrics is a dict with str keys and
(metric_value, target_weight) values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict with the same set of keys as input metrics and values of
(weighted_sum(metric_value), weighted_sum(target_weight)).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – if there exists a metric that exists in more than one element
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">loss_metric_weight_pairs</span></code> but not in all of them.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._AddVN">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_AddVN</code><span class="sig-paren">(</span><em>p</em>, <em>x</em>, <em>step=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_AddVN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._AddVN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.AddGlobalVN">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">AddGlobalVN</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#AddGlobalVN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.AddGlobalVN" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds variational noise to weights if specified by params.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.AddPerStepVN">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">AddPerStepVN</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>step=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#AddPerStepVN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.AddPerStepVN" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds per-setp variational noise to weights if specified by params.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.VariationalNoiseParams">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">VariationalNoiseParams</code><span class="sig-paren">(</span><em>scale</em>, <em>global_vn=False</em>, <em>per_step_vn=False</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#VariationalNoiseParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.VariationalNoiseParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a hyperparams for variational noise.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetStepSeed">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetStepSeed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetStepSeed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetStepSeed" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets step_seed.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ResetStepSeed">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ResetStepSeed</code><span class="sig-paren">(</span><em>seed=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ResetStepSeed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ResetStepSeed" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets step_seed to specified value.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetIncStepSeed">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetIncStepSeed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetIncStepSeed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetIncStepSeed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns and increments the step_seed.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GenerateStepSeedPair">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GenerateStepSeedPair</code><span class="sig-paren">(</span><em>p</em>, <em>global_step</em>, <em>op_seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GenerateStepSeedPair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GenerateStepSeedPair" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a seed pair for deterministic random operations in functional loops.</p>
<p>This function retrieves a unique seed pair on each call, based off the current
global step and step seed. The step seed ensures this function returns a
unique seed pair on each call: calling this function automatically increments
the step seed. The step seed is automatically reset at the beginning of each
global step in the model’s FProp and works transparently through recurrent.py.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p</strong> – A hyperparams.Params object, containing keys ‘random_seed’ and
‘is_inference’.</li>
<li><strong>global_step</strong> – The global step.</li>
<li><strong>op_seed</strong> – An additional operation-level seed to apply.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A size 2 tensor of op seeds to use for stateless_random ops.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.DeterministicDropout">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">DeterministicDropout</code><span class="sig-paren">(</span><em>x</em>, <em>keep_prob</em>, <em>seeds</em>, <em>noise_shape=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#DeterministicDropout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.DeterministicDropout" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.nn.dropout()</span></code>, but fully deterministic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – A float Tensor on which to apply dropout.</li>
<li><strong>keep_prob</strong> – A scalar <code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code> of keep probability.</li>
<li><strong>seeds</strong> – A Tensor of shape [2]. 2 seeds for deterministic random number
generator.</li>
<li><strong>noise_shape</strong> – A 1-D <code class="xref py py-obj docutils literal notranslate"><span class="pre">Tensor</span></code> of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">int32</span></code>, representing the shape for
randomly generated keep/drop flags.</li>
<li><strong>name</strong> – An optional name for this operation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A Tensor with the same shape as <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidArgumentError</span></code> – if keep_prob is invalid.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.UpdateBatchNormVars">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">UpdateBatchNormVars</code><span class="sig-paren">(</span><em>batch_norm_var</em>, <em>batch_norm_stats</em>, <em>decay</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#UpdateBatchNormVars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.UpdateBatchNormVars" title="Permalink to this definition">¶</a></dt>
<dd><p>Update batch normalization moving averages.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.FindRelevantBatchNormUpdates">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">FindRelevantBatchNormUpdates</code><span class="sig-paren">(</span><em>loss</em>, <em>batch_norm_updates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#FindRelevantBatchNormUpdates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.FindRelevantBatchNormUpdates" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds and returns a list of relevant batch-normalization updates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>loss</strong> – The loss that is being optimized for. A tensor or a list of tensors.</li>
<li><strong>batch_norm_updates</strong> – A list of batch normalization updates.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A pair of lists. The first list contains all the batch normalization updates
that are relevant to the loss being optimized, and the second list contains
all in batch_norm_updates but not in the first list.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.GetModelSplit">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">GetModelSplit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#GetModelSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.GetModelSplit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ModelSplit">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ModelSplit</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ModelSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ModelSplit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SampleStep">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SampleStep</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SampleStep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SampleStep" title="Permalink to this definition">¶</a></dt>
<dd><p>A context for a sample step during decoding.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">py_utils</span><span class="o">.</span><span class="n">SampleStep</span><span class="p">(</span><span class="n">step</span><span class="p">):</span>
  <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DecodeOneStep</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>step</strong> – the step tensor.</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body">a context manager for the step scope.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._GetSampleStep">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_GetSampleStep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_GetSampleStep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._GetSampleStep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.AddDebugTensor">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">AddDebugTensor</code><span class="sig-paren">(</span><em>tensor</em>, <em>summarize=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#AddDebugTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.AddDebugTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds <code class="xref py py-obj docutils literal notranslate"><span class="pre">tensor</span></code> to the debug collection.</p>
<p>Prints the tensor if <code class="xref py py-obj docutils literal notranslate"><span class="pre">--print_debug_tensors</span></code> is True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensor</strong> – A tensor.</li>
<li><strong>summarize</strong> – Only print this many entries of each tensor. If None, then a
maximum of 3 elements are printed per input tensor.</li>
<li><strong>name</strong> – An optional name for the tensor.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A Tensor that evaluates to the same value as the input tensor.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ArgMax">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ArgMax</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ArgMax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ArgMax" title="Permalink to this definition">¶</a></dt>
<dd><p>tf.argmax wrapper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inputs</strong> – A tensor, whose last dimension is being reduced on.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A tensor of rank tf.rank(logits)-1. If i == ret[indices],
logits[indices, i] is the maximum among logits[indices, :].</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._EnsureMatrixShape">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_EnsureMatrixShape</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_EnsureMatrixShape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._EnsureMatrixShape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.Matmul">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">Matmul</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#Matmul"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.Matmul" title="Permalink to this definition">¶</a></dt>
<dd><p>tf.matmul wrapper expecting x and y are actually matrices.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.clip_by_value">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">clip_by_value</code><span class="sig-paren">(</span><em>t</em>, <em>clip_value_min</em>, <em>clip_value_max</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#clip_by_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.clip_by_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils._TransformAndSum">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">_TransformAndSum</code><span class="sig-paren">(</span><em>tensor_list</em>, <em>transform</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#_TransformAndSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils._TransformAndSum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SumSquared">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SumSquared</code><span class="sig-paren">(</span><em>tensor_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SumSquared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SumSquared" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SumAbs">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SumAbs</code><span class="sig-paren">(</span><em>tensor_list</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SumAbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SumAbs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.PiecewiseConstant">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">PiecewiseConstant</code><span class="sig-paren">(</span><em>x_in</em>, <em>boundaries</em>, <em>values</em>, <em>vdtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#PiecewiseConstant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.PiecewiseConstant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the piecewise value of x_in.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.PadSequenceDimension">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">PadSequenceDimension</code><span class="sig-paren">(</span><em>x</em>, <em>length</em>, <em>pad_val</em>, <em>shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#PadSequenceDimension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.PadSequenceDimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Pads x to <code class="xref py py-obj docutils literal notranslate"><span class="pre">length</span></code> using <code class="xref py py-obj docutils literal notranslate"><span class="pre">pad_val</span></code> along the second dim.</p>
<p>Assumes <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> is a tensor with rank &gt;= 2, and it only pads <code class="xref py py-obj docutils literal notranslate"><span class="pre">x</span></code> to <code class="xref py py-obj docutils literal notranslate"><span class="pre">length</span></code>
along the second dim. Explicitly sets the returned tensor shape to <code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code> if
given. Raises runtime errors if x.shape[1] &gt; length or x.shape[i] != shape[i]
where i != 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – the tensor to be padded with shape [batch, seq_len, …].</li>
<li><strong>length</strong> – an int to specify the length to pad x to.</li>
<li><strong>pad_val</strong> – an int or float used to pad x.</li>
<li><strong>shape</strong> – an int array specifying the shape of the padded tensor if specified.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The padded tensor with shape [batch, seq_len, …], where
ret[:, :seq_len, …] == x.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ApplyPadding">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ApplyPadding</code><span class="sig-paren">(</span><em>padding</em>, <em>x</em>, <em>padded=None</em>, <em>broadcast=True</em>, <em>use_select=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ApplyPadding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ApplyPadding" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies padding to a tensor.</p>
<p>This is preferable to using arithmetic means for masking out padded values
such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equiv to ApplyPadding(padding, x))</span>
<span class="n">x</span> <span class="o">*=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">padding</span>
<span class="c1"># Equiv to ApplyPadding(padding, new, old)</span>
<span class="n">new</span> <span class="o">=</span> <span class="n">old</span> <span class="o">*</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">new</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">padding</span><span class="p">)</span>
</pre></div>
</div>
<p>Aside from just being easier to read and reason about, using this function
is friendly to quantized representations because it does not mix arithmetic
on the padding values with the values in the tensor being padded (which can
have a very different range than the 0..1 padding tensor).</p>
<p>In addition, this works around issues in quantized schemes where we are
guaranteed to have an exact 0 but not necessarily any other number (i.e. 1).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>padding</strong> – Tensor of padding values where 0 == keep and 1 == pad.</li>
<li><strong>x</strong> – Tensor to apply padding to.</li>
<li><strong>padded</strong> – Optional. Values to include for padded elements. Defaults to zeros.
Must be the same shape as ‘x’ if specified.</li>
<li><strong>broadcast</strong> – Whether to broadcast the padding shape to the shape of ‘x’. You
almost certainly want this to be true as it matches how padding would be
expanded if applied arithmetically.</li>
<li><strong>use_select</strong> – Controls whether padding is applied with a select-mask
(True/default) or arithmetically (False). Some platforms have a
sensitivity to one or the other and this is used to work around such
issues.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tensor with the same shape as x with padded values masked.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.TrimTrailingPaddings">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">TrimTrailingPaddings</code><span class="sig-paren">(</span><em>inputs</em>, <em>paddings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#TrimTrailingPaddings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.TrimTrailingPaddings" title="Permalink to this definition">¶</a></dt>
<dd><p>Trims trailing paddings from inputs.</p>
<p>Since the number of dimensions is not fixed, this will not work on TPU.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – a tensor with shape [batch, length, …].</li>
<li><strong>paddings</strong> – a tensor with shape [batch, length].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Trimmed inputs and paddings. For compatibility reasons, the trimmed tensors
will always have length at least 1.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.ReversePaddedSequence">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">ReversePaddedSequence</code><span class="sig-paren">(</span><em>inputs</em>, <em>paddings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#ReversePaddedSequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.ReversePaddedSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse inputs based on paddings.</p>
<p>Only reverse the unpadded portion of <code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs</span></code>. It assumes inputs are only
padded in the end.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – a tensor of [seq_length, batch_size, num_input_nodes].</li>
<li><strong>paddings</strong> – a tensor of float32/float64 zero or one of shape [seq_length,
batch_size, 1].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A reversed tensor of the same shape as <code class="xref py py-obj docutils literal notranslate"><span class="pre">inputs</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.Retry">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">Retry</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#Retry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.Retry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.RetryOnTransientTfError">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">RetryOnTransientTfError</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RetryOnTransientTfError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RetryOnTransientTfError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.PadOrTrimTo">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">PadOrTrimTo</code><span class="sig-paren">(</span><em>x</em>, <em>shape</em>, <em>pad_val=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#PadOrTrimTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.PadOrTrimTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad and slice x to the given shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – A tensor.</li>
<li><strong>shape</strong> – The shape of the returned tensor.</li>
<li><strong>pad_val</strong> – An int or float used to pad x.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">‘x’ is padded with pad_val and sliced so that the result has the given
shape.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.RepeatDim">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">RepeatDim</code><span class="sig-paren">(</span><em>tensor</em>, <em>multiple</em>, <em>axis</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RepeatDim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RepeatDim" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies elements in tensor’s axis “multiple” times, like np.repeat.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.StackTensorsRecursively">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">StackTensorsRecursively</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#StackTensorsRecursively"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.StackTensorsRecursively" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively stacks Tensors in a list of <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>values</strong> – a list of <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> or Tensors to stacks.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="#lingvo.core.py_utils.NestedMap" title="lingvo.core.py_utils.NestedMap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NestedMap</span></code></a> with stacked values or a stacked Tensor.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.MixByWeight">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">MixByWeight</code><span class="sig-paren">(</span><em>inputs</em>, <em>weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#MixByWeight"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.MixByWeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a weighted random choice and bprop type from the give inputs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inputs</strong> – a list of callables, where each callable returns a tf.Tensor or a
nested structure containing tf.Tensor. Function return types must be
consistent across elements. The tf.Operation to compute the result tensor
will only be invoked for one input at a time. For example, if each fn
represents an input record stream, a record will be drawn only from a
selected stream while the other streams will remain unchanged.</li>
<li><strong>weights</strong> – a 1D tensor of float &gt; 0 of the same length as inputs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A probablistic sample from the inputs proportional to the weights. The
return type will be the same as return type of individual ‘fn’ from the
inputs.
A one-hot vector of the source selected.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.CheckShapes">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">CheckShapes</code><span class="sig-paren">(</span><em>shapes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#CheckShapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.CheckShapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts that shapes is a tuple of tshape.Shape.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.FPropDtype">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">FPropDtype</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#FPropDtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.FPropDtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.UpdateFpropDtype">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">UpdateFpropDtype</code><span class="sig-paren">(</span><em>params</em>, <em>fprop_dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#UpdateFpropDtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.UpdateFpropDtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively update the fprop_dtype of the Params.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.UpdateDtype">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">UpdateDtype</code><span class="sig-paren">(</span><em>params</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#UpdateDtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.UpdateDtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively update the dtype of the Params.</p>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.NameScopeDecorator">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">NameScopeDecorator</code><span class="sig-paren">(</span><em>name_scope</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#NameScopeDecorator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.NameScopeDecorator" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorates a python function to introduce a tf.name_scope.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@py_utils</span><span class="o">.</span><span class="n">NameScopeDecorator</span><span class="p">(</span><span class="s1">&#39;foobar&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">MyFoobarMethod</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="c1"># ... Do TF things</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name_scope</strong> – The name scope to introduce.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A function decorator.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.SequencesToDebugStrings">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">SequencesToDebugStrings</code><span class="sig-paren">(</span><em>ids</em>, <em>lens</em>, <em>summarize=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#SequencesToDebugStrings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.SequencesToDebugStrings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns debug strings for the given sequences.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ids</strong> – int32 of [batch, len].</li>
<li><strong>lens</strong> – int32 of [batch].</li>
<li><strong>summarize</strong> – number of ids to summarize per sequence.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string tensor of [batch].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.RematerializeFn">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">RematerializeFn</code><span class="sig-paren">(</span><em>fn</em>, <em>*xs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#RematerializeFn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.RematerializeFn" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls fn and rematerializes fn in the backward pass.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fn(*xs)</span> <span class="pre">-&gt;</span> <span class="pre">ys</span></code>, where xs and ys can be a single tensor or a tuple of tensors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fn</strong> – A python function to be rematerialized in the backprop pass.</li>
<li><strong>*xs</strong> – A single tensor or a list/tuple of tensors. <code class="xref py py-obj docutils literal notranslate"><span class="pre">xs</span></code> are input args to the
fn function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fn(*xs)</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="lingvo.core.py_utils.StatefulRandomOpsInDefun">
<code class="descclassname">lingvo.core.py_utils.</code><code class="descname">StatefulRandomOpsInDefun</code><span class="sig-paren">(</span><em>func</em>, <em>graph=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingvo/core/py_utils.html#StatefulRandomOpsInDefun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lingvo.core.py_utils.StatefulRandomOpsInDefun" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the Defun depends on stateful random number ops.</p>
<p>Stateful random number generator ops should be avoid in Recurrent() call.
Otherwise, these ops produce inconsistent values between FProp and BProp.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> – a _DefinedFunction to check.</li>
<li><strong>graph</strong> – a Graph. Set None to use the default graph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of names of the stateful random ops.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidArgumentError</span></code> – if the input func/graph is invalid.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lingvo.core.quant_utils.html" class="btn btn-neutral float-right" title="lingvo.core.quant_utils module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lingvo.core.predictor.html" class="btn btn-neutral float-left" title="lingvo.core.predictor module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>